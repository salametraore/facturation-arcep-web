<!-- src/app/features/facturation/element-recus/element-recus-list-page.component.html -->
<mat-card>

  <!-- Titre de page (barre rose) -->
  <div class="page-title">
    <h2>Éléments de facturation reçus</h2>
  </div>

  <!-- Filtres compacts et centrés -->
  <div class="filters filters--one-line">
    <div class="filters-grid">

      <!-- Direction -->
      <mat-form-field>
        <mat-label>Direction</mat-label>
        <mat-select color="primary" [(ngModel)]="directionFilter" (selectionChange)="onDirectionChange($event.value)">
          <mat-option *ngFor="let item of directions" [value]="item.id">
            {{ item.libelle }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Catégorie de service -->
      <mat-form-field>
        <mat-label>Catégorie de service</mat-label>
        <mat-select color="primary" [(ngModel)]="serviceFilter" (selectionChange)="onCategorieChange($event.value)">
          <mat-option *ngFor="let item of filteredCategories" [value]="item.id">
            {{ item.libelle }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <!-- Boutons actions filtres -->
      <button mat-mini-fab color="primary" class="action-btn" (click)="chercher()">
        <mat-icon>search</mat-icon>
      </button>
      <button mat-mini-fab color="primary" class="action-btn" (click)="reset()">
        <mat-icon>cached</mat-icon>
      </button>

    </div>
  </div>

  <!-- Cadre standard -->
  <section class="list-box">

    <!-- En-tête : titre + actions à droite -->
    <div class="list-header">
      <h3 class="list-title">Liste — Éléments de facturation reçus</h3>

      <div class="list-actions">
        <!-- Exemple d’action secondaire si besoin (à activer plus tard)
        <button mat-stroked-button color="primary" (click)="onExport()">
          <mat-icon>print</mat-icon>
          Exporter
        </button>
        -->
      </div>
    </div>

    <!-- Corps : table + pagination -->
    <div class="list-body">
      <div class="mat-elevation-z10 compact-table">
        <table mat-table [dataSource]="t_ElementFacturationRecuCreeList" matSort style="width: 100%">

          <!-- Client -->
          <ng-container matColumnDef="client">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Client</th>
            <td mat-cell *matCellDef="let element">{{ element.client }}</td>
          </ng-container>

          <!-- Date soumission -->
          <ng-container matColumnDef="date_soumission">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Date soumission</th>
            <td mat-cell *matCellDef="let element">{{ element.date_soumission | date:'dd/MM/yyyy' }}</td>
          </ng-container>

          <!-- Catégorie -->
          <ng-container matColumnDef="categorie_produit_id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Catégorie</th>
            <td mat-cell *matCellDef="let element">{{ getCategorie(element.categorie_produit_id) }}</td>
          </ng-container>

          <!-- Type frais -->
          <ng-container matColumnDef="type_frais">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Type frais</th>
            <td mat-cell *matCellDef="let element">{{ getTypeFrais(element.type_frais) }}</td>
          </ng-container>

          <!-- Actions -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Actions</th>
            <td mat-cell *matCellDef="let element">
              <button mat-icon-button color="primary" [matMenuTriggerFor]="menu">
                <mat-icon>settings</mat-icon>
              </button>
              <mat-menu #menu="matMenu">
                <button mat-menu-item (click)="crud(element, this.operations.update)">
                  <mat-icon color="primary">edit</mat-icon>
                  Traiter
                </button>
              </mat-menu>
            </td>
          </ng-container>

          <!-- Lignes -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr
            mat-row
            *matRowDef="let element; columns: displayedColumns"
            (click)="onRowClicked(element)"
            [ngClass]="{ 'selected': element === selectedRow }">
          </tr>

          <!-- Ligne vide -->
          <tr mat-row *matNoDataRow>
            <td class="mat-cell" colspan="4">
              Aucune correspondance trouvée dans la base de données correspondant au critère de recherche
            </td>
          </tr>

        </table>

        <mat-paginator
          [pageSizeOptions]="[3, 5, 10, 15]"
          [pageSize]="5"
          showFirstLastButtons>
        </mat-paginator>
      </div>
    </div> <!-- /list-body -->

  </section>
</mat-card>
